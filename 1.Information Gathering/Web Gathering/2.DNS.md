## DNS

### Summary
DNS translates domain names to IP addresses and exposes useful recon data (records, name servers, subdomains); attackers commonly query DNS directly, brute-force subdomains, and use VHost fuzzing and Certificate Transparency logs to discover hidden assets.

------------------------------------------------------------

##  Find the IP address of a Domain
```bash 
host www.megacorpone.com

#Results
www.megacorpone.com has address 149.56.244.87
```
## DNS Recon Basics (dig)

### Task 1: Basic DNS lookup (A record default)

1. Run: `dig google.com`
   - Target-agnostic: `dig <DOMAIN>`
   - Example result:
     - `;; ->>HEADER<<- opcode: QUERY, status: NOERROR`
     - `;; ANSWER SECTION:`
     - `google.com. 0 IN A 142.251.47.142`

------------------------------------------------------------

### Task 2: Short output only

1. Run: `dig +short hackthebox.com`
   - Target-agnostic: `dig +short <DOMAIN>`
   - Example result:
     - `104.18.20.126`
     - `104.18.21.126`

------------------------------------------------------------

## Subdomain Bruteforcing (dnsenum)

### Task 1: Enumerate DNS + brute-force subdomains with a wordlist

1. Run: 
  ```
  dnsenum --enum inlanefreight.com -f /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -r
  ```
   - Target-agnostic: `dnsenum --enum <DOMAIN> -f <WORDLIST_PATH> -r`
   - Example result:
     - `inlanefreight.com. 300 IN A 134.209.24.248`
     - `Brute forcing with ...subdomains-top1million-20000.txt:`
     - `www.inlanefreight.com. 300 IN A 134.209.24.248`
     - `support.inlanefreight.com. 300 IN A 134.209.24.248`

------------------------------------------------------------

## Virtual Host Discovery (gobuster vhost)

### Summary
VHost fuzzing discovers sites hosted on the same IP by fuzzing the HTTP `Host` header (useful when DNS does not list the hostname).

### Brute-force virtual hosts using a wordlist

1. Run: 
   ```
   gobuster vhost -u http://inlanefreight.htb:81 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain
   ```
   - Target-agnostic: 
    ```
    gobuster vhost -u http://<TARGET_HOST_OR_IP>:<PORT> -w <WORDLIST_PATH> --append-domain
    ```
   - Example result:
     - `Gobuster v3.6`
     - `Starting gobuster in VHOST enumeration mode`
     - `Found: forum.<DOMAIN>:<PORT> Status: 200 [Size: 100]`
     - `Progress: 114441 / 114442 (100.00%)`

------------------------------------------------------------

## Certificate Transparency (crt.sh via curl + jq)

### Summary
CT logs expose certificate SAN entries, often revealing subdomains without brute-forcing.

### Task 1: Query crt.sh JSON and filter for subdomains containing a keyword

1. Run: 
   ```
   curl -s "https://crt.sh/?q=facebook.com&output=json" | jq -r '.[] | select(.name_value | contains("dev")) | .name_value' | sort -u
   ```
   - Target-agnostic: 
   ```
   curl -s "https://crt.sh/?q=<DOMAIN>&output=json" | jq -r '.[] | select(.name_value | contains("<FILTER>")) | .name_value' | sort -u`
   ```
   - Example result:
     - `dev.facebook.com`
     - `secure.dev.facebook.com`
     - `*.dev.facebook.com`
     - `newdev.facebook.com`


## DNS Zone Transfers

### Summary
A DNS zone transfer copies all DNS records for a domain from a DNS server; if misconfigured, it allows attackers to enumerate all subdomains, IPs, and DNS infrastructure.

------------------------------------------------------------

## DNS Zone Transfer Enumeration

### Task 1: Attempt a DNS zone transfer using dig

1. Run: 
   ```
   dig axfr @nsztm1.digi.ninja zonetransfer.me
   ```
   - Target-agnostic: 
    ```
    dig axfr @<DNS_SERVER> <DOMAIN>
    ```  
   - Purpose: Request a full DNS zone transfer (AXFR) from the authoritative name server.
   - Example result:
     - `zonetransfer.me. 7200 IN SOA nsztm1.digi.ninja. robin.digi.ninja. 2019100801 ...`
     - `zonetransfer.me. 7200 IN MX 0 ASPMX.L.GOOGLE.COM.`
     - `zonetransfer.me. 7200 IN A 5.196.105.14`
     - `canberra-office.zonetransfer.me. 7200 IN A 202.14.81.230`
     - `XFR size: 50 records`

------------------------------------------------------------
- NS: Nameserver records contain the name of the authoritative servers hosting the DNS records for a domain.
- A: Also known as a host record, the "a record" contains the IPv4 address of a hostname (such as www.megacorpone.com).
- AAAA: Also known as a quad A host record, the "aaaa record" contains the IPv6 address of a hostname (such as www.megacorpone.com).
- MX: Mail Exchange records contain the names of the servers responsible for handling email for the domain. A domain can contain multiple MX records.
- PTR: Pointer Records are used in reverse lookup zones and can find the records associated with an IP address.
- CNAME: Canonical Name Records are used to create aliases for other host records.
- TXT: Text records can contain any arbitrary data and be used for various purposes, such as domain ownership verification.

## Subdomain Enumeration


```bash
gobuster dns -d megacorpone.com -w wordlist.txt -t 10

# or
gobuster dir -u http://192.168.139.149 -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt
```