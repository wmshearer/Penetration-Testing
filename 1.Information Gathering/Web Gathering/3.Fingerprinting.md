## Fingerprinting

### Summary
Fingerprinting identifies a targetâ€™s web technologies (server, CMS, WAF, headers) so you can prioritize likely attack paths and spot outdated or misconfigured components.

------------------------------------------------------------

## Banner Grabbing (curl)

### Task 1: Grab HTTP headers (HTTP)

1. Run: `curl -I inlanefreight.com`
   - Target-agnostic: `curl -I <DOMAIN>`
   - Example result:
     - `HTTP/1.1 301 Moved Permanently`
     - `Server: Apache/2.4.41 (Ubuntu)`
     - `Location: https://inlanefreight.com/`

------------------------------------------------------------

### Task 2: Grab HTTP headers (HTTPS)

1. Run: `curl -I https://inlanefreight.com`
   - Target-agnostic: `curl -I https://<DOMAIN>`
   - Example result:
     - `HTTP/1.1 301 Moved Permanently`
     - `Server: Apache/2.4.41 (Ubuntu)`
     - `X-Redirect-By: WordPress`
     - `Location: https://www.inlanefreight.com/`

------------------------------------------------------------

### Task 3: Grab HTTP headers (www)

1. Run: `curl -I https://www.inlanefreight.com`
   - Target-agnostic: `curl -I https://www.<DOMAIN>`
   - Example result:
     - `HTTP/1.1 200 OK`
     - `Server: Apache/2.4.41 (Ubuntu)`
     - `Link: <https://www.inlanefreight.com/index.php/wp-json/>; rel="https://api.w.org/"`
     - `Content-Type: text/html; charset=UTF-8`

------------------------------------------------------------

## WAF Detection (wafw00f)

### Task 1: Install wafw00f

1. Run: `pip3 install git+https://github.com/EnableSecurity/wafw00f`
   - Example result:
     - `Successfully installed wafw00f-<VERSION>`

------------------------------------------------------------

### Task 2: Detect WAF in front of a target

1. Run: `wafw00f inlanefreight.com`
   - Target-agnostic: `wafw00f <DOMAIN>`
   - Example result:
     - `[*] Checking https://inlanefreight.com`
     - `[+] The site https://inlanefreight.com is behind Wordfence (Defiant) WAF.`
     - `[~] Number of requests: 2`

------------------------------------------------------------

## Fingerprinting with Nikto

### Task 1: Install Nikto dependencies + Nikto

1. Run: `sudo apt update && sudo apt install -y perl`
   - Example result:
     - `Setting up perl ...`

2. Run: `git clone https://github.com/sullo/nikto`
   - Example result:
     - `Cloning into 'nikto'...`

3. Run: `cd nikto/program`
   - Example result:
     - `(no output)`

4. Run: `chmod +x ./nikto.pl`
   - Target-agnostic: `chmod +x ./nikto.pl`
   - Example result:
     - `(no output)`

------------------------------------------------------------

### Task 2: Run Nikto software identification modules only

1. Run: `nikto -h inlanefreight.com -Tuning b`
   - Target-agnostic: `nikto -h <DOMAIN> -Tuning b`
   - Example result:
     - `+ Multiple IPs found: 134.209.24.248, 2a03:b0c0:1:e0::32c:b001`
     - `+ Target Hostname: www.inlanefreight.com`
     - `+ Target Port: 443`
     - `+ Server: Apache/2.4.41 (Ubuntu)`
     - `+ /index.php?: Uncommon header 'x-redirect-by' found, with contents: WordPress.`
     - `+ /: A Wordpress installation was found.`
     - `+ /wp-login.php: Wordpress login found.`
     - `+ /license.txt: License file found may identify site software.`
     - `+ 1316 requests: 0 error(s) and 12 item(s) reported on remote host`

------------------------------------------------------------
### Nmap Methodology for Port 80 - In Order

### Step 1 - Basic Service and Version Detection
```bash
sudo nmap -p80 -sV <TARGET IP>
```

### Step 2 - Default Script Scan
```bash
sudo nmap -p80 -sC <TARGET IP>
```

### Step 3 - Service Detection and Default Scripts Combined
```bash
sudo nmap -p80 -sV -sC <TARGET IP>
```

### Step 4 - HTTP Enumeration
```bash
sudo nmap -p80 --script http-enum <TARGET IP>
```

### Step 5 - HTTP Headers
```bash
sudo nmap -p80 --script http-headers <TARGET IP>
```

### Step 6 - HTTP Methods
```bash
sudo nmap -p80 --script http-methods <TARGET IP>
```

### Step 7 - HTTP Title
```bash
sudo nmap -p80 --script http-title <TARGET IP>
```

### Step 8 - HTTP Robots.txt
```bash
sudo nmap -p80 --script http-robots.txt <TARGET IP>
```

### Step 9 - All Safe HTTP Scripts
```bash
sudo nmap -p80 --script "http-* and safe" <TARGET IP>
```

### Step 10 - Vulnerability Scanning
```bash
sudo nmap -p80 --script vuln <TARGET IP>
```

### Step 11 - Safe HTTP Scripts and Vuln Combined
```bash
sudo nmap -p80 -sV --script "http-* and safe,vuln" <TARGET IP>
```

### Step 12 - SQL Injection
```bash
sudo nmap -p80 --script http-sql-injection <TARGET IP>
```

### Step 13 - Cross Site Scripting
```bash
sudo nmap -p80 --script http-csrf <TARGET IP>
```

### Step 14 - Shellshock
```bash
sudo nmap -p80 --script http-shellshock <TARGET IP>
```

### Step 15 - Brute Force (if login page found)
```bash
sudo nmap -p80 --script http-brute <TARGET IP>
```

### Step 16 - WordPress Specific (if CMS identified)
```bash
sudo nmap -p80 --script http-wordpress-enum <TARGET IP>
```

### Step 17 - Full Aggressive Scan (last resort, noisy and intrusive)
```bash
sudo nmap -p80 -sV -sC --script "http-*" <TARGET IP>
```