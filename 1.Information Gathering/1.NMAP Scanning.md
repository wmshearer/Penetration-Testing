# NMAP


## TCP NMAP

### Ping Scan (-Pn)
- Great for scanning targets blocking ICMP
1. Run:
```bash
nmap -Pn 192.168.50.149

# Target Agnostic:
nmap -Pn <TARGET IP>

#Scan all ports
nmap -Pn -p- 192.168.50.149
```

### Stealth Scan (-sS)
- Does not compelte 3-way handshake. Stops at SYN-ACK. Avoids application logs since the handshake never completes.
```bash
sudo nmap -sS 192.168.50.149
```
------------------------------------------------------------

### TCP Connect scan
- Takes much longer to establish TCP connection
```bash
nmap -sT 192.168.50.149
```
## OS Discovery
```bash
sudo nmap -O <TARGET IP>
```

## Agressive Scan (Once you know open ports)
```bash
nmap -sT -A -p 21,22,23,etc <TARGET IP>
```

## UDP Scan (-sU)
```bash
sudo nmap -sU 192.168.50.149

#Target Agnostic
sudo nmap -sU <TARGET IP>

#All Ports
sudo nmap -sU -p- <TARGET IP>
```

## Joint TCP/UDP Scan

```bash
sudo nmap -sU -sS 192.168.50.149

#Example Reusults
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-09 08:16 EST
Nmap scan report for 192.168.50.149
Host is up (0.10s latency).
Not shown: 989 closed tcp ports (reset), 977 closed udp ports (port-unreach)
PORT      STATE         SERVICE
53/tcp    open          domain
88/tcp    open          kerberos-sec
135/tcp   open          msrpc
139/tcp   open          netbios-ssn
389/tcp   open          ldap
445/tcp   open          microsoft-ds
464/tcp   open          kpasswd5
593/tcp   open          http-rpc-epmap
636/tcp   open          ldapssl
3268/tcp  open          globalcatLDAP
3269/tcp  open          globalcatLDAPssl
53/udp    open          domain
123/udp   open          ntp
389/udp   open          ldap
```

## Host Discovery

```bash
nmap -sn 192.168.50.1-255 -oG ping-sweep.txt
#Target Agnostic
nmap -sn <TARGET IP> -oG ping-sweep.txt

Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-10 03:19 EST
Nmap scan report for 192.168.50.6
#Host is up (0.12s latency).
Nmap scan report for 192.168.50.8
#Host is up (0.12s latency).
...
Nmap done: 254 IP addresses (13 hosts up) scanned in 3.74 seconds

# Save it to a readable format then grep the hosts that are up:
nmap -v -sn 192.168.50.1-255 -oG ping-sweep.txt

#then

grep Up ping-sweep.txt | cut -d " " -f 2
#192.168.50.6
#192.168.50.8
#192.168.50.9
```
![alt text](image.png)
## Running NMAP Scripts

```bash
nmap --script http-headers <TARGET IP>

#Need help with a script?
nmap --script-help http-headers
```
